## 数值计算方法

**了解**基础思想和简单算法

### 误差

误差：数值计算方法 与 分析计算方法 所得结果（量的计算值与真实值）之差。

$ssss$

> $x^*:真值$
>
> $x：测量值$
>
> $e=x^*-x：绝对误差$
>
> $e_r=\frac{e}{x^*}=\frac{x^*-x}{x^*}≈\frac{x^*-x}{x}$
>
> $|e|=|x^*-x|≤\varepsilon \Rightarrow x^*=x\pm\varepsilon：绝对误差限$
>
> 有效数字、数字的标准形式：$x^*=\pm10^m(0.abcdegh...),|x^*-x|≤\frac12\cdot10^{m-n}$

#### 误差的传播

<img src="https://s2.loli.net/2022/06/28/dzWjnqZQs84TFwo.png" alt="image-20220628105244532" style="zoom: 80%;" />

#### 误差的类型

- 舍入误差：计算过程中四舍五入造成的，计算机中十进制与二进制转换造成的误差

- 截断误差（方法误差）:将无穷的计算过程用有限的计算过程代替产生的误差（泰勒展开的余项）

  

### 方程的根

#### 一元方程的根

- 解析法 ：$x=\frac{-b\pm \sqrt{b^2-4ac}}{2a}$ （三次以上难以运算）
- 图解法：画出函数图像观察求解（存在绘图/观察的精度问题）
- **数值方法** 👇
  - 交叉法：（连续函数的介值定理） $f(x_1)f(x_2)<0 \Rightarrow \exist x∈(x_1,x_2),f(x)=0$，通过不断缩小区间范围，找到x的数值解。
  - 迭代法：<img src="https://s2.loli.net/2022/06/28/RLldShq5FjeovW9.png" alt="image-20220628112104144" style="zoom:50%;" />下为两种 g(x) 的取法
    - 牛顿法：$x_{i+1}=x_i-\frac{f(x_i)}{f'(x_i)}$
    - 弦截法：$x_{i+1}=x_i-\frac{f(x_i)(x_{i-1}-x_i)}{f(x_{i-1})-f(x_i)}$

####练习1：收敛性比较

<img src="https://s2.loli.net/2022/06/29/phQqcU6djmb7gTw.png" alt="image-20220629171215414" style="zoom: 67%;" />

已完成： `Training\Compare.m`

<img src="C:\Users\ccy\AppData\Roaming\Typora\typora-user-images\image-20220629180657381.png" alt="image-20220629180657381" style="zoom: 50%;" /><img src="C:\Users\ccy\AppData\Roaming\Typora\typora-user-images\image-20220629181351538.png" alt="image-20220629181351538" style="zoom: 50%;" />

```matlab
f = @(x)cos(x)-x %声明函数 f(x)=cosx-x

syms x
df=diff(f(x)) %对 f(x) 求导
```

怎么把y坐标换成对数？ ----把 `hold on` 语句放在 `semilogy(...)`绘图语句的后面

#### 数值方法的局限性

- 交叉法：对于偶数重根，左右两侧函数在x轴同一侧，不存在 $f(a)*f(b)<0$
- 牛顿法：零根附近的导数极小，可能不收敛/收敛过慢。

修改后的牛顿法： （n重根） $x_{i+1}=x_i-n\frac{f(x_i)}{f'(x_i)}$   为什么这样就可以了？？

###求解线性/非线性方程组

#### 直接法求解线性方程组

- 高斯消元
  - 主元素消去法-为了避免除以“零”（或极小），减小舍入误差
  - 某些系数特别大时，使用放缩减小误差（标准化）
- 追赶法求解三对角方程组

<img src="C:\Users\ccy\AppData\Roaming\Typora\typora-user-images\image-20220629194445942.png" alt="image-20220629194445942" style="zoom: 50%;" />



#### 迭代法求解线性方程组

对于线性方程组 $Ax=b$ ，可改写为 $x=Bx+f$，任给初值 $x^{(0)}$，可得 $x^{(k+1)}=Bx^{(k)}+f,k=0,1,2,...$![image-20220629195438190](C:\Users\ccy\AppData\Roaming\Typora\typora-user-images\image-20220629195438190.png)

![image-20220629195637144](C:\Users\ccy\AppData\Roaming\Typora\typora-user-images\image-20220629195637144.png)

收敛速度较慢，每次都要重新计算。

 ![image-20220629195810202](C:\Users\ccy\AppData\Roaming\Typora\typora-user-images\image-20220629195810202.png)

```matlab
% 解（二元）方程
syms x y % 声明变量
f1=x^2+2*y^2-8==0
f2=y-(exp(1))^x + 1==0
[xx,yy]=vpasolve(f1,f2,x,y)

%Unable to solve symbolically. Returning a numeric solution using vpasolve.
> In solve (line 304)
solve求不出解析解，这很常见，或者说能求出解析解的方程/方程组是少数
软件建议你改用vpasolve函数求数值解

[xx,yy]=vpasolve(f1,f2,x,y,1)
% 在1附近寻找解。该函数只输出一组解
```



## 多项式插值

利用函数$f (x)$在某区间中已知的若干点（插值点/采样点)的函数值（采样值）作出适当的特定函数，在区间的其他点上用这特定函数的值作为函数$f (x)$的近似值，这种方法称为**插值法**。如果这特定函数是多项式，就称它为**多项式插值**。

- 对于 n+1 给样本点，插值多项式 $P_n(x)$ 是存在唯一的。（给定**三个**点，一定可以确定一个**二次**函数...）

作用：拟合图像、近似积分

###拉格朗日插值法

<img src="C:\Users\ccy\AppData\Roaming\Typora\typora-user-images\image-20220629205132737.png" alt="image-20220629205132737" style="zoom: 67%;" />

局限：采样点发生变化时，所有的 L 都需要重新计算

###牛顿插值法

<img src="C:\Users\ccy\AppData\Roaming\Typora\typora-user-images\image-20220629210220979.png" alt="image-20220629210220979" style="zoom:67%;" />

局限：存储大量差商，占内存

优点：可以处理结尾增加采样点，只要增加一项即可



###实际情况中：分段线性插值

原因：实际应用中没有必要进行n次插值。

通常采用**分段三次插值**来确保插值后形成光滑（二阶光滑的三次）曲线，每四个点一组，两点一连线。

### 最佳平方逼近（最小二乘法）

<img src="C:\Users\ccy\AppData\Roaming\Typora\typora-user-images\image-20220629210747500.png" alt="image-20220629210747500" style="zoom:67%;" />

<img src="C:\Users\ccy\AppData\Roaming\Typora\typora-user-images\image-20220629211645152.png" alt="image-20220629211645152" style="zoom:67%;" />

实际上就是要解 $Ax=b$ 的线性非齐次方程，解出的列向量$x$就是一系列系数$C^*_i$

局限性：左侧矩阵不是特殊矩阵，方程组很难解，若变成只有主对角线上的元素非零才好算



<img src="C:\Users\ccy\AppData\Roaming\Typora\typora-user-images\image-20220629213433872.png" alt="image-20220629213433872" style="zoom:67%;" />

只有主对角线上的元素非零



<img src="C:\Users\ccy\AppData\Roaming\Typora\typora-user-images\image-20220629214402708.png" alt="image-20220629214402708" style="zoom:67%;" />

<img src="C:\Users\ccy\AppData\Roaming\Typora\typora-user-images\image-20220629214635312.png" alt="image-20220629214635312" style="zoom:67%;" />

#### 加权最佳平方逼近

<img src="C:\Users\ccy\AppData\Roaming\Typora\typora-user-images\image-20220629214910893.png" alt="image-20220629214910893" style="zoom:67%;" />

离散的只是把前面连续情况下的积分换成求和



## 差分方程与虫口模型

从斐波那契数列谈起。

### 斐波那契数列

$a_0=0,a_1=1,...,a_n=a_n=a_{n-1}+a_{n-2}$

通项公式 $a_n=\frac{1}{\sqrt{5}}[(\frac{1+\sqrt5}2)^n-(\frac{1-\sqrt5}2)^n],\lim\frac{a_n}{a_{n+1}}=\frac{\sqrt5-1}2，黄金分割比$

#### 例1、兔子对数的递推关系

<img src="C:\Users\ccy\AppData\Roaming\Typora\typora-user-images\image-20220705174205042.png" alt="image-20220705174205042" style="zoom:50%;" />

```python
import numpy as np
a=np.zeros(12)
a[0]=1
for i in range(len(a)):
    /* 如果兔子寿命6个月（第七个月死）
    if i>=6:
        a[i-6]=0
    */
    if i>=2:
        for j in range(i-1):
            a[i]+=a[j]
    print(a[i])
    print("There are {} rabbits in total".format(sum(a)))
    
% 总数通项 r_n=r_{n-2}+r_{n-1}的解释：
% 第n个月的兔子来自于 1.前一个月的兔子总数 2.前前一个月所有兔子生的兔子总数
```

#### 例2、分糖果问题

<img src="C:\Users\ccy\AppData\Roaming\Typora\typora-user-images\image-20220705180947111.png" alt="image-20220705180947111" style="zoom:50%;" />